\chapter{Literature Overview}\label{chap:lit}
\begin{overview}
  A summary of the mathematical techniques used in this dissertation is given in this chapter.
  Special attention is given to convex geometry and the properties of these sets.

  To place the Operability Index in context, process operability and methods to quantify it are reviewed.
  Finally, the Operability Index is defined and its application to model predictive controllers and their constraints are discussed.  
\end{overview}

\section{Mathematical Preliminaries}
\subsection{Convex Geometry}
\subsubsection{Nomenclature}
The following nomenclature is reviewed and used throughout this document \citep[487]{bayerlee}:
\begin{itemize}
\item polytope - the intersection of closed half-spaces in $\mathbb{R}^n$.
A polytope of $n$ dimensions will simply be referred to as an $n$-polytope.
\item vertex - a 0-dimensional face of an \npoly.
\item facet - an $(n-1)$-dimensional face of an \npoly.
\end{itemize}%
\nomenclature[a]{$n$}{Number of dimensions (variables)}%

\subsubsection{Half-space geometry}\label{sec:hgeometry}
A half-space is defined as the section of an $n$-dimensional space lying on one side of an ($n-1$)-dimensional hyperplane \citep[1282]{crcmaths}.
Linear constraints are equivalent to half-spaces in $\mathbb{R}^n$ in both their mathematical description and meaning.
From this we can conclude that all polytopes generated by linear constraints (half-spaces) are convex, as they have supporting hyperplanes at each boundary point \citep[21]{manilev}.
From this it also follows that the intersection of such convex polytopes will be convex.
This is due to the resulting intersection being merely a subset of the half-spaces defining the two intersecting polytopes.

The problem of degeneracy can occur when constructing polytopes from half-spaces.
Degeneracy is defined when objects ``change their nature to belong to another, usually simpler, class'' \citep[688]{crcmaths}.
The degeneracy of polytopes is important for the purposes of this dissertation.
When the number of half-spaces used to construct a polytope is more than the final number of facets on the resulting closed polytope, the polytope is classified as degenerate.

\subsubsection{Convex hull and vertex enumeration}
The convex hull or facet enumeration is used extensively for calculations in this project.
It is defined as the smallest convex set containing $P$ if $P$ is a set of points ($P \subseteq \mathbb{R}^n$) \citep[74]{wenger}.
In this project, $P$ is generated from a set of half-spaces and the resulting vertices are the minimum vertex description of $P$.
For this reason the convex hull of $P$ and the half-spaces used to generate $P$ are equivalent.

The opposite of facet enumeration is vertex enumeration, where a set of half-spaces are transformed to the vertices of $P$.
A primal-dual method can be implemented to solve this problem.
The full mathematical formulation of the primal-dual algorithm is omitted from this document.
\citet[636-639]{primaldual1} and \citet{primaldual2} can be consulted for the full formulation. 

\subsubsection{Linear transformations}
Define $X$ and $Y$ as finite-dimensional sets with bases $(x_1,\dots,x_n)$ and $(y_1,\dots,y_m)$ respectively.
For the linear transformation $\phi : X \to Y$, the following holds:
\begin{equation}
  \label{eq:lintrans}
  \phi(y_i) = \alpha_{i1}x_i+\cdots+\alpha_{in}x_n \text{~~~for~} i = 1, \dots, m
\end{equation}
The scalars $(\alpha_{ij})_{i=1,\dots,n;~j=1,\dots,m}$ can be written as
\begin{equation}
  \bpm
    \alpha_{11} &\cdots &\cdots &\alpha_{1n} \\
    \alpha_{21} &\cdots &\cdots &\alpha_{2n} \\
    \cdots     &\cdots &\cdots &\cdots \\
    \alpha_{m1} &\cdots &\cdots &\alpha_{mn} \\
  \epm \notag
\end{equation}
which is referred to as the matrix of $\phi$ \citep[48-49,~166]{leung}.

Equation~\ref{eq:lintrans} is equivalent to the result of the following matrix multiplication
\begin{equation}
  \label{eq:matmult}
  \Phi X = Y
\end{equation}
where $\Phi$ is the matrix of $\phi$.
Equation~\ref{eq:matmult} confirms that matrix multiplication is indeed a linear transformation.

\subsection{Process models}
The mathematical description of process models and specifically the space transformations those lead to are of importance.

\subsubsection{Linear steady-state}
The steady-state model of a linear system is the gain-matrix.
This is simply a matrix of constants in $\mathbb{R}$.
Models like these allow for matrix algebra when transforming between spaces, e.g. a matrix multiplication of the input space and the process model has the output space as result.

The transformation obtained for linear models are conformal mappings.
This is defined as a mapping that preserves local angles and has a non-zero differential at every point \citep[514]{crcmaths}.
Being conformal, the surface (or boundary) of the input space (a polytope) maps directly to the surface of the output space.
For this reason, the constraints specifying a space can be used to generate the corresponding space with full mathematical rigour.

\subsubsection{Non-linear models}
The mapping of spaces via non-linear models is not guaranteed to be conformal.
Therefore, the statement that boundaries map to boundaries in their corresponding spaces, cannot be made.

A practical example of this is illustrated by \citet{opidealrx}, for a vinyl acetate reactor where a set of inputs map to the same point in the output space.
In this case, the phenomena of input multiplicities is ascribed to a rank deficiency of the Jacobian matrix of the process model.


\section{Process Operability}
The method of constraint handling presented in this document, is largely derived from work done by Georgakis and colleagues, in particular \citet{vinsonphd}, \citet{vinsonartoi}, \citet{limaphd}, \citet{opconproc} and \citet{opidealrx}. 
To place the Operability Index of \citet{vinsonphd} (defined in section~\ref{sec:oi}) in context, a short overview of process operability and the most common process operability techniques is presented below.

\subsection{Overview}
Process operability is defined as ``the ease with which a process can be operated and controlled'' \citep[778]{marlin}.
Process operability is an ongoing field of study with many of the methods available being only qualitative \citep[164]{skogestad}. 
A distinction is made between steady-state (input and output relationships at steady-state only) and dynamic operability methods.

\subsubsection{Steady-state operability measures}
The relative gain array (RGA) is one of the most used operability measures \citep[576]{luyben} and relates input and output interactivity.
Each element in the RGA ($\beta_{ij}$) is defined as the ratio of the steady-state gain ratios between input, $i$, and output, $j$, when all other inputs and outputs are constant.
\citet{artrdg} defined the RDG, which expanded on the RGA to include the effect of disturbances. 
Considering only the magnitudes of RGA elements can be misleading \citep[87]{skogestad}, as seemingly favourable pairings can be unfavourable due to the phase.
Therefore, both the magnitude and the phase need to be considered or, alternatively, norms such as the RGA-number can be used.


The Niederlinski index is another measure that only uses steady-state gains of the process model \citep[572-573]{luyben}.
Positive values of the Niederlinski index can correspond to unstable pairings and are therefore inconclusive.
For this reason, the index is considered necessary but not sufficient for stability \citep[445]{skogestad}.

Singular value decomposition stems from the use of eigenvalues as an operability measure. 
The use of singular values are preferred as eigenvalues are a poor
measure of gain and can often be misleading \citep[75]{skogestad}.
Maximum and minimum singular values are mostly used to select controlled variables but can also be used as a performance measure along with the condition number \citepp{596}{luyben}{80-82}{skogestad}.

\subsubsection{Dynamic operability measures}
The RGA can be expanded to contain frequency-dependant terms and is often referred to as the dynamic relative gain array (DRGA) \citep[637]{marlin}. 
The RDG \citep{artrdg} can be expanded in a similar way to include frequency-dependant terms.

Nyquist array methods as defined by Rosenbrock, as quoted by \citet[92]{skogestad}, are an extension of the SISO Nyquist stability criteria that include frequency dynamics. 
The two methods developed are the direct Nyquist array and the inverse Nyquist array. 
When used in conjunction with Gershgorin bands, conditions for overall stability can be derived \citep[440]{skogestad}.

\citet{vinsonphd} lists other dynamic operability measures which rely on the choice of a controller type. Further shortcomings of the above mentioned operability measures are also discussed in that text. 

\subsection{Operability Index}\label{sec:oi}
The Operability Index was defined by \citet{vinsonphd} as a measure of steady-state process operability. 
Constraint interdependence is used as the basis of this index. 
Further work by \citet{limaphd} expanded this index to cover non-square systems and some application to dynamic systems.%
\nomenclature[ba]{OI}{Operability Index}%

\subsubsection{Definitions}
The Operability Index focuses on input-output relationships rather the system's dynamic states \citep{vinsonphd}. 
Input and output values are defined by spaces (in $\mathbb{R}^n$ and $\mathbb{R}^m$, with $n$ the number of inputs and $m$ the number of outputs). 
These spaces are the feasible regions which are bounded by the inequalities describing the ranges of the inputs or outputs. 
The following spaces are of interest:%
\nomenclature[a]{$u$}{System inputs}%
\nomenclature[a]{$x$}{System states}%
\nomenclature[a]{$y$}{System outputs}%

\begin{description}
  \item [Available Input Space (AIS);] the set of attainable values of the process inputs. 
    The limits on these values are based on both physical limits (e.g.     valve openings) or process design values (e.g. flow-rates or temperatures). 
Figure~\ref{fig:sampleaisaos} illustrates an AIS for two variables ($u_1, u_2$) bounded by simple high and low limits.%
\nomenclature[ba]{AIS}{Available Input Space}%
  \item [Achievable Output Space (AOS);] this is the set of values which the process outputs can obtain, given the AIS. 
The AIS maps to the AOS by means of a process model, $G$. 
Therefore, a point $u$ in the AIS corresponds to a point $y$ in the AOS via $y=G(u)$. 
Examples of AOSs for linear and non-linear models are shown in figure~\ref{fig:sampleaisaos}.%
\nomenclature[a]{$G$}{Process model}%
\nomenclature[ba]{AOS}{Available Output Space}%
  \item [Desired Output Space (DOS);] this represents the desired output values of a process. 
These values are typically based on operational and financial   parameters. 
Figure~\ref{fig:sampledos} shows a sample DOS for a two output    system along with a sample AOS.%
\nomenclature[ba]{DOS}{Desired Output Space}%
  \item [Expected Disturbance Space (EDS);] all the values of the expected disturbances to the system. 
These values are translated back to the input space by means of the disturbance model, $G_d$.%
\nomenclature[ba]{EDS}{Expected Disturbance Space}%
  \item [Desired Input Space (DIS);] in the same manner that the AIS maps to the AOS, the DIS represents combined reverse mappings of the DOS and EDS.
The DIS is calculated as the inputs, $u$, that satisfy the model, i.e. $y=G(u,d)$ (with $y$ and $d$ from the DOS and EDS respectively).
Figure~\ref{fig:sampledis} shows this combined translation.%
\nomenclature[a]{$d$}{System disturbance}%
\nomenclature[ba]{DIS}{Desired Input Space}%
\end{description}

\begin{figure}[htbp]
  \centering
%  \includegraphics[width=8cm]{graph/sample_ais}
  \scalebox{1}{\input{graph/sampleaisaos}}
  \caption[Sample Available Input Space mapping to Achievable Output Space]{Sample Available Input Space (AIS) mapping via a linear model ($y=G\vect{u}$) and a non-linear model ($y=f(\vect{u})$) to the Achievable Output Space (AOS)}
  \label{fig:sampleaisaos}
\end{figure}

\begin{figure}[htbp]
  \centering
%  \includegraphics[width=8cm]{graph/sample_dos}
  \scalebox{1}{\input{graph/sampledos}}
  \caption[Sample Desired Output Space]{Sample Desired Output Space (DOS, with linear constraints on both outputs) along with a linear AOS}
  \label{fig:sampledos}
\end{figure}

\begin{figure}[htbp]
  \centering
%  \includegraphics[width=\fullwidth]{graph/sample_dis}
  \scalebox{1}{\input{graph/sampledis}}
  \caption[Sample Desired Input Space]{Sample Desired Input Space (DIS) for
    a linear model and rectangular DOS and EDS}
  \label{fig:sampledis}
\end{figure}

\citet{vinsonphd} defines the generalised Output Operability Index (OOI\nomenclature[ba]{OOI}{Output Operability Index}) as shown in equation~\ref{eq:genooi}. 
From this definition it is clear that the operability of a process decreases if the AOS does not cover the whole DOS. 
Servo- and regulatory operability indices are also defined in the text, but are not shown here.
\begin{equation}
  \label{eq:genooi}
     OOI \triangleq \frac{\mu(AOS\cap DOS)}{\mu(DOS)}
\end{equation}
where $\mu$ represents a function to calculate the volume of a space.%
\nomenclature[ga]{$\mu$}{Volume of a polytope}%

All the concepts above are directly applicable to square systems.
For the case of non-square systems (more outputs than inputs) the Operability Index formulation is extended to interval operability. 
In this case, process outputs are split into two categories; setpoint controlled variables and range controlled variables.
The first being controlled on a given setpoint, whereas the later is allowed to vary within its given maximum and minimum limits.

\citet{limaphd} elaborates on the interval operability of linear non-square systems and defines the following spaces:
\begin{description}
  \item [The interval AOS (AOS$_I$);] which is the union of all AOS($d$) where $d$ is within the EDS. 
This is typically generated by the shifting of AOS($d=0$) in the directions determined by $G_d$ (the disturbance model).%
\nomenclature[ba]{AOS$_I$}{Interval AOS}%
  \item [The Achievable Output Interval Set (AOIS);] defined as a rectangle with the same aspect ratio as the DOS, bound by the lines (or hyperplanes) that correspond to the minimum and maximum values of $d$ in the AOS. 
Since the issue of interval operability is being addressed, the AOIS does not need to be strictly contained within the AOS$_I$.%
\nomenclature[ba]{AOIS}{Achievable Output Interval Set}%
\end{description}
\citet{limaphd} proceeds to define a hyper-volume ratio (HVR) as shown in equation~\ref{eq:hvr}. 
The aim being here to define a measure for obtaining tighter control on CVs by reducing the size of the DOS (without causing infeasibilities). 
The process remains interval controllable as long as the AOIS remains a subset of the DOS (AOIS$\subseteq$DOS).
\begin{equation}
  \label{eq:hvr}
    HVR = \frac{\mu(DOS)}{\mu(AOIS)}
\end{equation}
where $\mu$ represents a function to calculate the volume of a space.%
\nomenclature[ba]{CV}{Controlled variable}%
\nomenclature[ba]{MV}{Manipulated variable}%
\nomenclature[ba]{DV}{Disturbance variable}%

To change the relative importance (tightness of control) on variables, weights are imposed on the AOIS. 
This in turn affects the aspect ratio of the AOIS.

\citet{limaphd} proposes two methods to calculate an AOIS for higher dimensional systems; an iterative method and a method based on linear programming (LP). 
In both cases, this corresponds to the tightest set of output constraints which still render the system controllable. 
Both methods are briefly discussed below:
\begin{itemize}
  \item Iterative approach; this method relies on the use of computational geometry tools to calculate convex hulls and intersections. 
An AOIS is initially estimated and expanded until it intersects the extreme subsets of the AOS. 
The magnitude by which the AOIS is increased is calculated using the Secant and bisection method. 
The calculations contained in this method are computationally intensive and limit its use to systems of 8 dimensions and lower.
  \item LP approach; in this approach the constraints and objective function are reformulated as linear functions. 
The extreme subsets of the AOS are expressed as linear inequalities and objective function set up as to determine the common intersection point of the AOIS and a given extreme subset. 
The proposed LP approach overcomes the computational intensity of the iterative method and is suitable for on-line calculation of the AOIS.
\end{itemize}

\subsubsection{Application}
Numerous authors have illustrated the application of the Operability Index (OI). 
\citet{opconproc} focus on a general application of the OI, emphasising its ability to identify inoperable processes without the need to specify a controller structure. 
\citet{opidealrx} applies the OI to the design of ideal reactors. 

\subsection{Operability Index application to MPC}
Although the  Operability Index can be used with square or non-square, linear or non-linear models, its easiest application is to linear models. 
This is advantageous as most of the current MPCs use linear models \citep{vinsonphd}.
Table~\ref{tab:mpcoi} highlights some properties of MPCs which lend themselves to the  application of the Operability Index.%
\nomenclature[ba]{MPC}{Model Predictive Control(ler)}%
\begin{table}[htbp]
  \centering
  \caption[Application of the Operability Index to MPC]{Application of the
    Operability Index to MPC \citep{vinsonphd}}
  \label{tab:mpcoi}
    \begin{tabular}{p{6cm} p{9cm}}
      \toprule
      MPC property & Operability Index property \\
      \midrule
      Linear process models & Calculation of the relevant spaces (AOS and DIS) is usually fast.\\[1.3ex]
      Constraints on MVs and CVs & In the case of fixed constraints; the input and output constraints result in polytopes in both the input and output spaces. 
From these descriptions the framework of Operability Index can be directly applied.\\[1.3ex]
      Solution of MV and CV steady state targets  & Where an LP solver is used, the Operability Index can yield useful information about process characteristics.\\
      \bottomrule
    \end{tabular}
\end{table}

\citet{vinsonphd} presents a list of additional issues that limit the performance of MPCs (with specific attention to AspenTech's DMCplus$^{\copyright}$) and proposes methods (using the Operability Index) to solve these problems. 
These methods are indirectly applicable to the proposed constraint handling method of this document and are presented here for that reason. 

Processes with considerable noise cause targets to move with each controller execution.
Typical ways to avoid this are limiting MV stepsize or filtering CVs, both of which have a stabilizing effect but result in a more sluggish controller. 
These limits may also cause the controller to not reach optimum solutions.
Using the OI and the associated output spaces, the possible outputs of a (newly) limited input space are clearly shown.
    
Disturbances can cause CVs to violate their constraints. 
In some cases, the controller might give up on a constraint and continue (now using a subset of the CVs).
Possible solutions include; model re-identification (in the case of an inconsistency), fixing the source of the disturbance or adding a DV to account for the disturbance.
Due to the fixed constraints on MVs and CVs the resulting AIS and DOS can be used to calculate the controller's ability to reject a disturbance. 
A measure of controller robustness can be derived from this.
    
Lastly, move suppression factors for MVs and give-ups for CVs are used to tune MPCs for dynamic performance.
The choice of these factors are usually qualitative and according to guidelines (and validated via offline simulations).
The OI (and its associated spaces) can provide guidance in determining move suppression factors and give-ups. 
The difficulty in controlling a CV at a given constraint can be derived from the OI.
How far a CV constraint can be moved (given the MV constraints) can also be determined from the OI.

% Local Variables:
% TeX-master: "AHC_thesis"
% End:
